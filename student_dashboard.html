<!DOCTYPE html>
<html lang="si" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Dashboard - O/L Mathematics by Sudeepa Wishva</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366f1',
                        secondary: '#ec4899',
                        dark: '#0f172a',
                        card: '#1e293b',
                        success: '#10b981',
                        danger: '#ef4444',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'float-delayed': 'float 6s ease-in-out 3s infinite',
                        'float-fast': 'float 5s ease-in-out infinite',
                        'float-reverse': 'float-reverse 7s ease-in-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        },
                        'float-reverse': {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(20px)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Outfit', sans-serif;
        }
    </style>
</head>

<body class="bg-dark text-white min-h-screen flex flex-col md:flex-row">

    <!-- Sidebar -->
    <aside class="w-full md:w-64 bg-card border-r border-white/5 flex-shrink-0">
        <div onclick="showSection('welcome')"
            class="p-6 border-b border-white/5 flex items-center gap-3 cursor-pointer hover:bg-white/5 transition-colors group">
            <img src="assets/logo.png" alt="Logo"
                class="w-12 h-12 rounded-full border border-white/10 shadow-lg object-contain bg-white/5 group-hover:scale-110 transition-transform">
            <div>
                <h1 class="font-bold text-lg leading-tight group-hover:text-primary transition-colors">O/L Mathematics
                </h1>
                <p class="text-xs text-gray-400">Student Portal</p>
            </div>
        </div>

        <nav class="p-4 space-y-2">
            <button onclick="showSection('dashboard')" id="nav-dashboard"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-xl bg-white/5 text-primary font-medium hover:bg-white/10 transition-colors text-left">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z">
                    </path>
                </svg>
                Dashboard
            </button>
            <button onclick="showSection('payments')" id="nav-payments"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors text-left">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z">
                    </path>
                </svg>
                Payments
            </button>
            <button onclick="showSection('marks')" id="nav-marks"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors text-left">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                    </path>
                </svg>
                My Marks
            </button>
            <button onclick="showSection('tutor')" id="nav-tutor"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors text-left">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                About Tutor
            </button>
            <button onclick="showSection('profile')" id="nav-profile"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors text-left">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
                My Profile
            </button>
            <button onclick="db.logout()"
                class="w-full flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/5 text-gray-400 hover:text-white transition-colors mt-auto">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1">
                    </path>
                </svg>
                Logout
            </button>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-8 overflow-y-auto relative">
        <header class="flex justify-between items-center mb-8">
            <div>
                <h2 class="text-2xl font-bold mb-1 flex items-center gap-2">
                    Hello, <span id="studentName">Student</span>! üëã
                </h2>
                <p class="text-gray-400 text-sm">Let's learn something new today.</p>
            </div>

            <!-- Edit Profile Modal Removed (Replaced by Tab) -->
            <div id="paymentStatus"
                class="px-4 py-2 rounded-full text-sm font-bold bg-gray-700 text-gray-300 relative z-10">
                Checking Status...
            </div>
        </header>

        <!-- Floating Background (Hidden on Welcome) -->
        <div id="dashboard-bg"
            class="absolute inset-0 pointer-events-none overflow-hidden z-0 opacity-0 transition-opacity duration-1000">
            <!-- Icons -->
            <div class="absolute top-10 left-10 text-primary/10 animate-float text-6xl">œÄ</div>
            <div class="absolute top-1/2 left-20 text-secondary/10 animate-float-delayed text-8xl">Œ£</div>
            <div class="absolute bottom-20 right-20 text-green-500/10 animate-float-reverse text-7xl">‚à´</div>
            <div class="absolute top-20 right-32 text-purple-500/10 animate-float-fast text-5xl">‚àöx</div>
            <div class="absolute bottom-1/3 left-1/3 text-blue-500/10 animate-float-delayed text-9xl font-serif">Œ∏</div>
            <div class="absolute top-5 right-10 text-yellow-500/10 animate-float text-4xl">‚àû</div>
            <div class="absolute bottom-10 left-10 text-red-500/10 animate-float-reverse text-6xl">√∑</div>
            <div class="absolute top-1/3 right-1/4 text-indigo-500/10 animate-float-fast text-5xl">¬±</div>
        </div>

        <!-- WELCOME LANDING -->
        <section id="sec-welcome" class="hidden space-y-8 animate-fade-in">
            <!-- Hero -->
            <!-- Hero -->
            <div
                class="relative rounded-3xl overflow-hidden bg-gradient-to-br from-indigo-900 to-dark border border-white/10 p-8 md:p-12 flex flex-col-reverse md:flex-row items-center justify-between gap-8">

                <!-- Text Content -->
                <div class="flex-1 text-center md:text-left z-10 w-full">
                    <h2 class="text-4xl md:text-6xl font-bold mb-6 leading-tight text-white drop-shadow-lg">
                        Welcome to<br>
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary to-purple-400">O/L
                            Mathematics</span><br>
                        <span class="text-2xl text-gray-300 font-medium block mt-2">by Sudeepa Wishva</span>
                    </h2>

                    <div
                        class="text-gray-200 text-lg mb-8 space-y-4 max-w-xl mx-auto md:mx-0 bg-white/5 p-6 rounded-2xl border border-white/10 backdrop-blur-sm">
                        <p class="text-2xl font-bold text-white border-b border-white/10 pb-2">‡∂¥‡∑î‡∑Ö‡∑î‡∑Ä‡∂±‡∑ä ‡∑Ä‡∑ô‡∂±‡∑ä‡∂±‡∂∏ ‡∂â‡∂ú‡∑ô‡∂± ‡∂ú‡∂∏‡∑î.
                        </p>
                        <p class="leading-relaxed text-sm md:text-base">
                            For grade 6, 7, 8, 9, 10 and 11 students,<br>
                            There are Theory / Revision and Paper Classes.<br>
                            Contact me.
                        </p>
                        <div class="text-sm text-gray-300 border-l-4 border-primary pl-4 py-1 mt-4">
                            <strong class="text-white block text-base">Sudeepa Wishva</strong>
                            <span class="opacity-80">BSc Engineering (Hons.) | University of Sri Jayewardenepura
                                (UG)</span>
                        </div>
                    </div>

                    <button onclick="showSection('dashboard')"
                        class="px-8 py-4 bg-white text-dark font-bold text-lg rounded-xl hover:scale-105 hover:bg-gray-100 transition-all shadow-xl shadow-primary/20 flex items-center gap-2 mx-auto md:mx-0">
                        Go to Classroom üöÄ
                    </button>
                </div>

                <!-- Floating Math Icons Animation -->
                <div
                    class="flex-shrink-0 relative w-[300px] h-[300px] md:w-[450px] md:h-[450px] flex justify-center items-center mt-8 md:mt-0 scale-90 md:scale-100">
                    <!-- Glow behind -->
                    <div class="absolute inset-0 bg-primary/20 blur-[100px] rounded-full"></div>

                    <!-- Main Circle/Orbit System -->
                    <div class="relative w-full h-full">

                        <!-- Centerpiece: Pi -->
                        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-20 animate-float">
                            <div
                                class="w-32 h-32 md:w-36 md:h-36 bg-gradient-to-br from-indigo-600 to-purple-600 rounded-[2rem] flex items-center justify-center shadow-2xl shadow-indigo-500/40 rotate-12 border border-white/20 backdrop-blur-md group hover:scale-105 transition-transform duration-500">
                                <span
                                    class="text-6xl md:text-7xl text-white font-serif font-bold group-hover:rotate-12 transition-transform">œÄ</span>
                            </div>
                        </div>

                        <!-- Top Right: Sigma -->
                        <div class="absolute top-10 right-10 z-10 animate-float-delayed">
                            <div
                                class="w-20 h-20 bg-card/80 backdrop-blur-xl rounded-2xl flex items-center justify-center shadow-xl border border-white/10 -rotate-6 hover:border-secondary/50 transition-colors">
                                <span class="text-4xl text-secondary font-bold">Œ£</span>
                            </div>
                        </div>

                        <!-- Bottom Left: Root -->
                        <div class="absolute bottom-20 left-4 z-10 animate-float-fast">
                            <div
                                class="w-24 h-24 bg-card/80 backdrop-blur-xl rounded-2xl flex items-center justify-center shadow-xl border border-white/10 rotate-6 hover:border-green-500/50 transition-colors">
                                <span class="text-4xl text-green-400 font-bold">‚àöx</span>
                            </div>
                        </div>

                        <!-- Top Left: Infinity -->
                        <div class="absolute top-16 left-8 z-0 animate-float-reverse opacity-80">
                            <div
                                class="w-16 h-16 bg-white/5 backdrop-blur-md rounded-2xl flex items-center justify-center shadow-lg border border-white/5 -rotate-12">
                                <span class="text-3xl text-blue-400">‚àû</span>
                            </div>
                        </div>

                        <!-- Bottom Right: Integral -->
                        <div class="absolute bottom-12 right-12 z-0 animate-float opacity-80">
                            <div
                                class="w-20 h-20 bg-white/5 backdrop-blur-md rounded-2xl flex items-center justify-center shadow-lg border border-white/5 rotate-12">
                                <span class="text-5xl text-purple-400 font-serif">‚à´</span>
                            </div>
                        </div>

                        <!-- Mini Icon: Theta -->
                        <div class="absolute top-0 left-1/2 z-0 animate-float-delayed">
                            <div
                                class="w-12 h-12 bg-primary/20 backdrop-blur-md rounded-xl flex items-center justify-center shadow-lg border border-white/5 rotate-45">
                                <span class="text-2xl text-primary">Œ∏</span>
                            </div>
                        </div>

                        <!-- Mini Icon: Plus/Minus -->
                        <div class="absolute bottom-4 left-1/2 z-0 animate-float-reverse">
                            <div
                                class="w-14 h-14 bg-secondary/20 backdrop-blur-md rounded-xl flex items-center justify-center shadow-lg border border-white/5 -rotate-12">
                                <span class="text-2xl text-secondary font-bold">¬±</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Quick Access Grid -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Quote -->
                <div
                    class="lg:col-span-2 bg-gradient-to-r from-primary/10 to-purple-500/10 border border-white/5 rounded-2xl p-8 flex items-center justify-center text-center">
                    <div>
                        <svg class="w-8 h-8 text-primary/50 mx-auto mb-4" fill="currentColor" viewBox="0 0 24 24">
                            <path
                                d="M14.017 21L14.017 18C14.017 16.8954 14.9124 16 16.017 16H19.017C19.5693 16 20.017 15.5523 20.017 15V9C20.017 8.44772 19.5693 8 19.017 8H15.017C14.4647 8 14.017 7.55228 14.017 7V3H19.017C20.6739 3 22.017 4.34315 22.017 6V15C22.017 16.6569 20.6739 18 19.017 18H16.017V21H14.017ZM5.0166 21L5.0166 18C5.0166 16.8954 5.91203 16 7.0166 16H10.0166C10.5689 16 11.0166 15.5523 11.0166 15V9C11.0166 8.44772 10.5689 8 10.0166 8H6.0166C5.46432 8 5.0166 7.55228 5.0166 7V3H10.0166C11.6735 3 13.0166 4.34315 13.0166 6V15C13.0166 16.6569 11.6735 18 10.0166 18H7.0166V21H5.0166Z">
                            </path>
                        </svg>
                        <p class="text-xl font-serif italic text-gray-300">"Mathematics is not about numbers, equations,
                            computations, or algorithms: it is about understanding."</p>
                        <p class="text-sm text-primary mt-3">- William Paul Thurston</p>
                    </div>
                </div>

                <!-- Tutor Card (Mini) -->
                <div class="bg-card hover:bg-white/5 border border-white/5 rounded-2xl p-6 transition-all group cursor-pointer"
                    onclick="showSection('tutor')">
                    <div class="flex items-center gap-4 mb-4">
                        <img src="assets/tutor.png"
                            class="w-12 h-12 rounded-full object-cover border border-white/10 group-hover:border-primary transition-colors">
                        <div>
                            <h4 class="font-bold">Your Tutor</h4>
                            <p class="text-xs text-gray-400">Sudeepa Wishva</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-400">Need help? Contact me via WhatsApp or check the profile.</p>
                </div>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div onclick="showSection('dashboard')"
                    class="p-4 bg-white/5 rounded-xl text-center hover:bg-primary/20 transition-all cursor-pointer border border-white/5">
                    <div class="text-2xl mb-2">üìö</div>
                    <div class="font-bold text-sm">Lessons</div>
                </div>
                <div onclick="showSection('payments')"
                    class="p-4 bg-white/5 rounded-xl text-center hover:bg-green-500/20 transition-all cursor-pointer border border-white/5">
                    <div class="text-2xl mb-2">üí≥</div>
                    <div class="font-bold text-sm">Payments</div>
                </div>
                <div onclick="showSection('marks')"
                    class="p-4 bg-white/5 rounded-xl text-center hover:bg-secondary/20 transition-all cursor-pointer border border-white/5">
                    <div class="text-2xl mb-2">üìä</div>
                    <div class="font-bold text-sm">Marks</div>
                </div>
                <div onclick="showSection('tutor')"
                    class="p-4 bg-white/5 rounded-xl text-center hover:bg-blue-500/20 transition-all cursor-pointer border border-white/5">
                    <div class="text-2xl mb-2">üë®‚Äçüè´</div>
                    <div class="font-bold text-sm">Tutor</div>
                </div>
            </div>

            <!-- Social Link -->
            <div class="mt-8 grid md:grid-cols-2 gap-6">
                <!-- Facebook -->
                <a href="#" target="_blank" id="linkFb"
                    class="block w-full bg-[#1877F2] hover:bg-[#166fe5] text-white p-6 rounded-2xl transition-transform hover:scale-[1.02] shadow-lg shadow-blue-500/20 group relative overflow-hidden hidden">
                    <div
                        class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl -translate-y-1/2 translate-x-1/2 group-hover:scale-150 transition-transform duration-500">
                    </div>
                    <div class="flex items-center justify-between relative z-10">
                        <div class="flex items-center gap-4">
                            <div class="p-3 bg-white/20 rounded-xl backdrop-blur-sm">
                                <svg class="w-8 h-8 md:w-10 md:h-10 text-white" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.791-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg md:text-xl">Facebook Page</h3>
                                <p class="text-blue-100 text-sm">Follow for updates</p>
                            </div>
                        </div>
                    </div>
                </a>

                <!-- YouTube -->
                <a href="#" target="_blank" id="linkYt"
                    class="block w-full bg-[#FF0000] hover:bg-[#e60000] text-white p-6 rounded-2xl transition-transform hover:scale-[1.02] shadow-lg shadow-red-500/20 group relative overflow-hidden hidden">
                    <div
                        class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl -translate-y-1/2 translate-x-1/2 group-hover:scale-150 transition-transform duration-500">
                    </div>
                    <div class="flex items-center justify-between relative z-10">
                        <div class="flex items-center gap-4">
                            <div class="p-3 bg-white/20 rounded-xl backdrop-blur-sm">
                                <svg class="w-8 h-8 md:w-10 md:h-10 text-white" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                        d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z" />
                                </svg>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg md:text-xl">YouTube Channel</h3>
                                <p class="text-white/80 text-sm">Watch video lessons</p>
                            </div>
                        </div>
                    </div>
                </a>
            </div>
        </section>

        <!-- DASHBOARD (Content) -->
        <section id="sec-dashboard">
            <div id="lockedMessage"
                class="hidden mb-8 p-6 rounded-2xl bg-red-500/10 border border-red-500/20 flex flex-col items-center justify-center text-center">
                <div class="w-12 h-12 rounded-full bg-red-500/20 text-red-500 flex items-center justify-center mb-3">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z">
                        </path>
                    </svg>
                </div>
                <h3 class="text-lg font-bold text-white mb-2">Content Locked</h3>
                <p class="text-gray-400 text-sm mb-4">You have not paid for the current month. Please pay <strong>LKR
                        1000</strong> cash to the teacher to unlock study materials.</p>
                <button onclick="showSection('payments')"
                    class="px-6 py-2 bg-white/10 hover:bg-white/20 text-white text-sm font-bold rounded-lg transition-colors">
                    Check Payment Status
                </button>
            </div>

            <div id="contentArea">
                <!-- Live Classes -->
                <section class="mb-10">
                    <h3 class="text-xl font-bold mb-4 border-l-4 border-primary pl-3">Live Classes</h3>
                    <div id="liveClasses" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Populated via JS -->
                    </div>
                </section>

                <!-- Recs -->
                <section class="mb-10">
                    <h3 class="text-xl font-bold mb-4 border-l-4 border-secondary pl-3">Recordings</h3>
                    <div id="recordings" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Populated via JS -->
                    </div>
                </section>

                <!-- PDFs -->
                <section class="mb-10">
                    <h3 class="text-xl font-bold mb-4 border-l-4 border-purple-500 pl-3">Study Materials</h3>
                    <div id="pdfs" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Populated via JS -->
                    </div>
                </section>
            </div>
        </section>

        <!-- PAYMENTS -->
        <section id="sec-payments" class="hidden">
            <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                <span class="w-2 h-8 bg-green-500 rounded-full"></span>
                My Payments
            </h3>

            <div class="grid md:grid-cols-2 gap-8">
                <!-- Payment Card -->
                <div class="bg-card rounded-2xl p-8 border border-white/5 shadow-xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-10">
                        <svg class="w-32 h-32 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z">
                            </path>
                        </svg>
                    </div>

                    <h4 class="text-gray-400 text-sm uppercase tracking-wider mb-2">Current Month</h4>
                    <div class="text-3xl font-bold text-white mb-6" id="payMonthName">February 2026</div>

                    <div id="payStatusContainer">
                        <!-- Dynamically updated -->
                    </div>
                </div>

                <!-- History -->
                <div class="bg-card rounded-2xl p-8 border border-white/5">
                    <h4 class="font-bold mb-4">Payment History</h4>
                    <div id="paymentHistory" class="space-y-3">
                        <!-- List -->
                    </div>
                </div>
            </div>
        </section>

        <!-- MARKS -->
        <section id="sec-marks" class="hidden text-white">
            <!-- Same content as before, moved into section -->
            <h3 class="text-xl font-bold mb-4 border-l-4 border-green-500 pl-3">Performance</h3>
            <div class="grid lg:grid-cols-3 gap-8">
                <div class="lg:col-span-2 bg-card rounded-2xl p-6 border border-white/5">
                    <canvas id="marksChart"></canvas>
                </div>
                <div class="bg-card rounded-2xl p-6 border border-white/5">
                    <h4 class="font-bold mb-4">Recent Exams</h4>
                    <div id="marksList" class="space-y-3"></div>
                </div>
            </div>
        </section>

        <!-- TUTOR PROFILE -->
        <section id="sec-tutor" class="hidden">
            <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                <span class="w-2 h-8 bg-blue-500 rounded-full"></span>
                About the Tutor
            </h3>

            <!-- ... (existing tutor content) ... -->
            <div
                class="bg-card rounded-3xl p-8 md:p-10 border border-white/5 relative overflow-hidden max-w-4xl mx-auto shadow-2xl">
                <!-- Background Decoration -->
                <div class="absolute top-0 right-0 p-10 opacity-5 pointer-events-none">
                    <svg class="w-64 h-64 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1"
                            d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z">
                        </path>
                    </svg>
                </div>

                <div class="flex flex-col md:flex-row items-center gap-10 relative z-10">
                    <!-- Photo -->
                    <div class="flex-shrink-0">
                        <div
                            class="w-48 h-56 md:w-60 md:h-72 rounded-2xl overflow-hidden border-4 border-white/10 shadow-2xl relative group">
                            <div
                                class="absolute inset-0 bg-primary/20 group-hover:bg-transparent transition-all duration-500">
                            </div>
                            <!-- Placeholder image, user needs to add assets/tutor.png -->
                            <img src="assets/tutor.png" alt="Sudeepa Wishva" class="w-full h-full object-cover">
                        </div>
                    </div>

                    <!-- Details -->
                    <div class="flex-1 text-center md:text-left">
                        <h2 class="text-3xl font-bold mb-2">Sudeepa Wishva</h2>
                        <div
                            class="inline-block px-4 py-1.5 rounded-full bg-white/5 border border-white/10 text-primary text-sm font-semibold mb-6">
                            BSc Engineering (Hons.) | University of Sri Jayewardenepura (UG)
                        </div>

                        <div class="space-y-4">
                            <div
                                class="flex items-center justify-center md:justify-start gap-4 p-4 rounded-xl bg-dark/50 border border-white/5 hover:border-primary/30 transition-colors">
                                <div
                                    class="w-10 h-10 rounded-full bg-green-500/20 text-green-400 flex items-center justify-center">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z">
                                        </path>
                                    </svg>
                                </div>
                                <div class="text-left">
                                    <p class="text-xs text-gray-400 uppercase tracking-widest">Mobile</p>
                                    <p class="font-mono text-lg font-bold">072 802 9239</p>
                                </div>
                            </div>

                            <div
                                class="flex items-center justify-center md:justify-start gap-4 p-4 rounded-xl bg-dark/50 border border-white/5 hover:border-green-500/30 transition-colors">
                                <div
                                    class="w-10 h-10 rounded-full bg-green-600/20 text-green-500 flex items-center justify-center">
                                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                        <path
                                            d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
                                    </svg>
                                </div>
                                <div class="text-left">
                                    <p class="text-xs text-gray-400 uppercase tracking-widest">WhatsApp Only</p>
                                    <p class="font-mono text-lg font-bold">070 227 9805</p>
                                </div>
                            </div>

                            <div
                                class="flex items-center justify-center md:justify-start gap-4 p-4 rounded-xl bg-dark/50 border border-white/5 hover:border-purple-500/30 transition-colors">
                                <div
                                    class="w-10 h-10 rounded-full bg-purple-500/20 text-purple-400 flex items-center justify-center">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z">
                                        </path>
                                    </svg>
                                </div>
                                <div class="text-left">
                                    <p class="text-xs text-gray-400 uppercase tracking-widest">Email</p>
                                    <p class="font-mono text-lg font-bold">sudeepawishva@yahoo.com</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- MY PROFILE -->
        <section id="sec-profile" class="hidden">
            <h3 class="text-xl font-bold mb-6 flex items-center gap-2">
                <span class="w-2 h-8 bg-purple-500 rounded-full"></span>
                My Profile
            </h3>

            <div class="bg-card rounded-2xl p-8 border border-white/5 max-w-2xl">
                <form id="profileForm" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">Full Name</label>
                            <input type="text" id="profName"
                                class="w-full px-4 py-3 rounded-lg bg-dark border border-white/10 text-white focus:border-primary focus:outline-none"
                                required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">School</label>
                            <input type="text" id="profSchool"
                                class="w-full px-4 py-3 rounded-lg bg-dark border border-white/10 text-white focus:border-primary focus:outline-none"
                                required>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-400 mb-2">Mobile Number (Registers for
                            Barcode)</label>
                        <input type="tel" id="profPhone"
                            class="w-full px-4 py-3 rounded-lg bg-dark border border-white/10 text-white focus:border-primary focus:outline-none"
                            pattern="[0-9]{10}" placeholder="0771234567" required>
                    </div>

                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">Grade (Fixed)</label>
                            <input type="text" id="profGrade"
                                class="w-full px-4 py-3 rounded-lg bg-dark/50 border border-white/5 text-gray-500 cursor-not-allowed"
                                disabled>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-400 mb-2">Email (Fixed)</label>
                            <input type="text" id="profEmail"
                                class="w-full px-4 py-3 rounded-lg bg-dark/50 border border-white/5 text-gray-500 cursor-not-allowed"
                                disabled>
                        </div>
                    </div>

                    <div class="pt-4 border-t border-white/5 flex justify-end">
                        <button type="submit"
                            class="px-8 py-3 rounded-xl bg-primary hover:bg-primary/90 text-white font-bold shadow-lg shadow-primary/20 transition-all transform hover:scale-105">
                            Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </section>

    </main>

    <script src="js/db.js"></script>
    <script>
        const user = db.refreshSession();
        if (!user || user.role !== 'student') {
            window.location.href = 'login.html';
        }

        document.getElementById('studentName').innerText = user.name;
        const currentMonthName = new Date().toLocaleString('default', { month: 'long', year: 'numeric' });
        const currentMonthKey = new Date().toISOString().slice(0, 7); // YYYY-MM
        document.getElementById('payMonthName').innerText = currentMonthName;

        // --- Load Social Settings ---
        function loadSocialLinks() {
            const settings = db.getSettings();

            // Facebook
            const fbBtn = document.getElementById('linkFb');
            if (settings.facebook && settings.facebook !== '#' && settings.facebook.trim() !== '') {
                fbBtn.href = settings.facebook;
                fbBtn.classList.remove('hidden');
            } else {
                fbBtn.classList.add('hidden');
            }

            // YouTube
            const ytBtn = document.getElementById('linkYt');
            if (settings.youtube && settings.youtube !== '#' && settings.youtube.trim() !== '') {
                ytBtn.href = settings.youtube;
                ytBtn.classList.remove('hidden');
            } else {
                ytBtn.classList.add('hidden');
            }
        }
        loadSocialLinks();

        // --- Navigation ---
        function showSection(id) {
            // Hide all sections
            ['dashboard', 'payments', 'marks', 'tutor', 'welcome', 'profile'].forEach(s => {
                document.getElementById('sec-' + s).classList.add('hidden');
                // Reset nav styles
                const n = document.getElementById('nav-' + s);
                if (n) {
                    n.classList.remove('bg-white/5', 'text-primary', 'font-medium');
                    n.classList.add('text-gray-400');
                }
            });

            // Show target
            document.getElementById('sec-' + id).classList.remove('hidden');

            // Highlight nav
            const activeNav = document.getElementById('nav-' + id);
            if (activeNav) {
                activeNav.classList.remove('text-gray-400');
                activeNav.classList.add('bg-white/5', 'text-primary', 'font-medium');
            }

            // Refresh specific data
            if (id === 'dashboard') checkAccessAndLoad();
            if (id === 'payments') loadPaymentTab();
            if (id === 'dashboard') checkAccessAndLoad();
            if (id === 'payments') loadPaymentTab();
            if (id === 'marks') loadMarks();
            if (id === 'profile') loadProfile();

            // Handle Background
            const bg = document.getElementById('dashboard-bg');
            if (id === 'welcome') {
                bg.classList.add('opacity-0');
            } else {
                bg.classList.remove('opacity-0');
            }
        }

        // --- Dashboard Logic ---
        function checkAccessAndLoad() {
            const isPaid = db.checkPayment(user.id);
            const statusEl = document.getElementById('paymentStatus');

            if (isPaid) {
                statusEl.innerText = "‚úÖ Paid: " + currentMonthName;
                statusEl.className = "px-4 py-2 rounded-full text-sm font-bold bg-green-500/20 text-green-400 border border-green-500/30";
                document.getElementById('lockedMessage').classList.add('hidden');
                document.getElementById('contentArea').classList.remove('opacity-20', 'pointer-events-none');
                loadContent();
            } else {
                statusEl.innerText = "‚ùå Unpaid: " + currentMonthName;
                statusEl.className = "px-4 py-2 rounded-full text-sm font-bold bg-red-500/20 text-red-400 border border-red-500/30";

                // Show Locked UI
                document.getElementById('lockedMessage').classList.remove('hidden');
                document.getElementById('contentArea').classList.add('opacity-20', 'pointer-events-none');

                // Clear real content to be safe visually
                document.getElementById('liveClasses').innerHTML = '';
                document.getElementById('pdfs').innerHTML = '';
                document.getElementById('recordings').innerHTML = '';
            }
        }

        function loadContent() {
            const content = db.getContent(user.grade);

            const liveContainer = document.getElementById('liveClasses');
            const pdfContainer = document.getElementById('pdfs');
            const recContainer = document.getElementById('recordings');

            liveContainer.innerHTML = ''; pdfContainer.innerHTML = ''; recContainer.innerHTML = '';

            content.forEach(item => {
                const card = document.createElement('div');
                card.className = "bg-card hover:bg-card/80 border border-white/5 rounded-2xl p-6 transition-all hover:-translate-y-1 hover:shadow-xl group";

                let icon = '';
                let btnText = 'View';
                let btnColor = 'text-primary';

                if (item.type === 'link') {
                    icon = '<div class="w-12 h-12 rounded-lg bg-primary/20 text-primary flex items-center justify-center mb-4"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg></div>';
                    btnText = 'Join Class';
                    liveContainer.appendChild(card);
                } else if (item.type === 'pdf') {
                    icon = '<div class="w-12 h-12 rounded-lg bg-secondary/20 text-secondary flex items-center justify-center mb-4"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div>';
                    btnText = 'Download PDF';
                    btnColor = 'text-secondary';
                    pdfContainer.appendChild(card);
                } else if (item.type === 'recording') {
                    icon = '<div class="w-12 h-12 rounded-lg bg-red-500/20 text-red-500 flex items-center justify-center mb-4"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div>';
                    btnText = 'Watch Now';
                    btnColor = 'text-red-500';
                    recContainer.appendChild(card);
                }

                card.innerHTML = `
                    ${icon}
                    <h4 class="font-bold text-lg mb-2 truncate">${item.title}</h4>
                    <p class="text-gray-400 text-sm mb-4 line-clamp-2">${item.details}</p>
                    <a href="${item.url}" target="_blank" class="${btnColor} font-semibold text-sm hover:underline flex items-center gap-1">
                        ${btnText} <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
                    </a>
                `;
            });
        }

        // --- Payment Logic ---
        function loadPaymentTab() {
            const isPaid = db.checkPayment(user.id);
            const container = document.getElementById('payStatusContainer');

            if (isPaid) {
                container.innerHTML = `
                    <div class="px-6 py-4 rounded-xl bg-green-500/20 border border-green-500/30 text-green-400 flex items-center gap-3">
                        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        <div>
                            <div class="font-bold">Payment Completed</div>
                            <div class="text-xs opacity-80">Thank you for your payment!</div>
                        </div>
                    </div>
                 `;
            } else {
                container.innerHTML = `
                    <div class="bg-yellow-500/10 border border-yellow-500/20 p-4 rounded-xl text-yellow-500">
                        <p class="font-bold mb-2">Payment Required: LKR 1000</p>
                        <p class="text-sm opacity-80 mb-4">Please make a cash payment to the teacher to unlock this month's content. Your status will be updated manually upon payment.</p>
                        <div class="flex items-center gap-2 text-xs opacity-60">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            Waiting for teacher confirmation...
                        </div>
                    </div>
                 `;
            }

            // History
            const historyDiv = document.getElementById('paymentHistory');
            historyDiv.innerHTML = '';
            const currentUserData = db.getCurrentUser(); // Refresh user data to get payments

            if (currentUserData.payments.length === 0) {
                historyDiv.innerHTML = '<p class="text-gray-500 text-sm italic">No past payments found.</p>';
            } else {
                currentUserData.payments.sort().reverse().forEach(p => {
                    const row = document.createElement('div');
                    row.className = "flex justify-between items-center p-3 rounded-lg bg-dark border border-white/5";
                    row.innerHTML = `
                        <span class="text-sm font-medium text-gray-300">${p}</span>
                        <span class="text-xs font-bold text-green-400 px-2 py-1 bg-green-500/10 rounded">PAID</span>
                     `;
                    historyDiv.appendChild(row);
                });
            }
        }

        // --- Marks Logic ---
        function loadMarks() {
            const marksData = db.getStudentMarks(user.id);
            const marksList = document.getElementById('marksList');
            const labels = [];
            const scores = [];

            marksList.innerHTML = '';
            if (marksData.length === 0) {
                marksList.innerHTML = '<p class="text-gray-500 text-sm italic">No marks recorded yet.</p>';
            } else {
                marksData.forEach(m => {
                    labels.push(m.exam);
                    scores.push(m.score);

                    const item = document.createElement('div');
                    item.className = "flex justify-between items-center p-3 rounded-lg bg-dark border border-white/5";
                    item.innerHTML = `
                        <span class="text-sm font-medium">${m.exam}</span>
                        <span class="text-sm font-bold ${m.score >= 75 ? 'text-green-400' : 'text-yellow-400'}">${m.score}%</span>
                    `;
                    marksList.appendChild(item);
                });

                // Render Chart
                if (window.myChart) window.myChart.destroy(); // Destroy old chart to avoid overlay
                const ctx = document.getElementById('marksChart').getContext('2d');
                window.myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Performance Trend',
                            data: scores,
                            borderColor: '#6366f1',
                            backgroundColor: 'rgba(99, 102, 241, 0.1)',
                            borderWidth: 2,
                            fill: true,
                            tension: 0.4,
                            pointBackgroundColor: '#ec4899'
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { beginAtZero: true, max: 100, grid: { color: 'rgba(255, 255, 255, 0.05)' }, ticks: { color: '#9ca3af' } },
                            x: { grid: { display: false }, ticks: { color: '#9ca3af' } }
                        }
                    }
                });
            }
        }



        // --- Profile Tab ---
        function loadProfile() {
            // Get latest user data
            const currentUser = db.getCurrentUser();
            if (!currentUser) return;

            document.getElementById('profName').value = currentUser.name || '';
            document.getElementById('profSchool').value = currentUser.school || '';
            document.getElementById('profPhone').value = currentUser.phone || '';
            document.getElementById('profGrade').value = currentUser.grade || '';
            document.getElementById('profEmail').value = currentUser.contact || '';
        }

        document.getElementById('profileForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('profName').value;
            const school = document.getElementById('profSchool').value;
            const phone = document.getElementById('profPhone').value;

            // Validate phone
            if (phone.length !== 10) {
                alert("Please enter a valid 10-digit phone number");
                return;
            }

            const res = db.updateUser(user.id, { name, school, phone });

            if (res.success) {
                alert("Profile Updated Successfully!");
                // Refresh local user reference
                Object.assign(user, db.getCurrentUser());
                document.getElementById('studentName').innerText = user.name;
            } else {
                alert("Error updating profile.");
            }
        });

        // Init
        showSection('welcome');
    </script>
</body>

</html>